<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üáßüá© Bangladesh Map Puzzle - FunLearnBD</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Baloo+Da+2:wght@400;600;700;800&family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00a86b;
            --primary-dark: #006b45;
            --secondary: #ff6b35;
            --accent: #ffd700;
            --pink: #ff69b4;
            --purple: #9b59b6;
            --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            --text-dark: #2d3436;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Baloo Da 2', 'Hind Siliguri', sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated Background */
        .bg-bubbles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 0;
        }

        .bubble {
            position: absolute;
            bottom: -100px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 50%;
            animation: rise 15s infinite ease-in;
        }

        .bubble:nth-child(1) { width: 40px; height: 40px; left: 10%; animation-duration: 12s; }
        .bubble:nth-child(2) { width: 20px; height: 20px; left: 20%; animation-duration: 15s; animation-delay: 2s; }
        .bubble:nth-child(3) { width: 50px; height: 50px; left: 35%; animation-duration: 18s; animation-delay: 4s; }
        .bubble:nth-child(4) { width: 80px; height: 80px; left: 50%; animation-duration: 20s; }
        .bubble:nth-child(5) { width: 35px; height: 35px; left: 65%; animation-duration: 14s; animation-delay: 3s; }
        .bubble:nth-child(6) { width: 45px; height: 45px; left: 80%; animation-duration: 16s; animation-delay: 5s; }

        @keyframes rise {
            0% { transform: translateY(0) rotate(0deg); opacity: 0.5; }
            100% { transform: translateY(-120vh) rotate(720deg); opacity: 0; }
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 12px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 100;
        }

        .header-title {
            color: white;
            font-size: 1.1em;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .lang-selector {
            display: flex;
            gap: 5px;
        }

        .lang-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.4);
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lang-btn.active {
            background: white;
            color: var(--primary-dark);
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.3em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            transform: scale(1.1) rotate(-10deg);
        }

        /* Container */
        .container {
            position: relative;
            z-index: 1;
            padding: 15px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Screens */
        .screen {
            display: none;
            animation: bounceIn 0.5s ease;
        }

        .screen.active {
            display: block;
        }

        @keyframes bounceIn {
            0% { opacity: 0; transform: scale(0.8); }
            50% { transform: scale(1.02); }
            100% { opacity: 1; transform: scale(1); }
        }

        /* Mascot */
        .mascot-container {
            position: relative;
            display: inline-block;
        }

        .mascot {
            font-size: 100px;
            animation: mascotBounce 1s ease-in-out infinite;
            cursor: pointer;
            transition: transform 0.2s;
            filter: drop-shadow(0 8px 20px rgba(0,0,0,0.3));
        }

        .mascot:hover {
            transform: scale(1.1);
        }

        .mascot.celebrate {
            animation: mascotCelebrate 0.6s ease;
        }

        @keyframes mascotBounce {
            0%, 100% { transform: translateY(0) rotate(-3deg); }
            50% { transform: translateY(-15px) rotate(3deg); }
        }

        @keyframes mascotCelebrate {
            0% { transform: scale(1) rotate(0); }
            25% { transform: scale(1.3) rotate(-15deg); }
            50% { transform: scale(1.3) rotate(15deg); }
            75% { transform: scale(1.3) rotate(-15deg); }
            100% { transform: scale(1) rotate(0); }
        }

        /* Speech Bubble */
        .speech-bubble {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 15px 22px;
            border-radius: 25px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            font-size: 1.1em;
            font-weight: 600;
            color: var(--text-dark);
            white-space: nowrap;
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .speech-bubble::after {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 50%;
            transform: translateX(-50%);
            border: 12px solid transparent;
            border-top-color: white;
        }

        .speech-bubble.show {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        /* Menu */
        .menu-hero {
            text-align: center;
            padding: 20px;
        }

        .menu-hero h1 {
            font-size: 2.5em;
            color: white;
            text-shadow: 3px 3px 0 rgba(0,0,0,0.2);
            margin: 20px 0 10px;
        }

        .menu-hero p {
            color: rgba(255,255,255,0.9);
            font-size: 1.2em;
            margin-bottom: 25px;
        }

        .menu-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 340px;
            margin: 0 auto;
        }

        .menu-btn {
            background: white;
            border: none;
            border-radius: 20px;
            padding: 20px 28px;
            font-size: 1.2em;
            font-weight: 700;
            color: var(--text-dark);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .menu-btn:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .menu-btn:active {
            transform: scale(0.98);
        }

        .menu-btn .emoji {
            font-size: 1.5em;
        }

        /* Puzzle Layout */
        .puzzle-header {
            background: white;
            border-radius: 20px;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .puzzle-title {
            font-size: 1.3em;
            font-weight: 800;
            color: var(--primary-dark);
        }

        .puzzle-progress {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .progress-pills {
            display: flex;
            gap: 5px;
        }

        .progress-pill {
            width: 28px;
            height: 10px;
            border-radius: 5px;
            background: #e0e0e0;
            transition: all 0.3s ease;
        }

        .progress-pill.filled {
            background: linear-gradient(135deg, var(--secondary), #e74c3c);
        }

        .timer {
            font-size: 1.5em;
            font-weight: 800;
            color: var(--purple);
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 8px 18px;
            border-radius: 15px;
        }

        /* Game Area */
        .game-area {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        @media (min-width: 850px) {
            .game-area {
                grid-template-columns: 1.5fr 1fr;
            }
        }

        /* Map Container */
        .map-panel {
            background: white;
            border-radius: 25px;
            padding: 20px;
            box-shadow: var(--shadow);
            position: relative;
        }

        .map-wrapper {
            position: relative;
            width: 100%;
            max-width: 550px;
            margin: 0 auto;
        }

        .map-background {
            width: 100%;
            height: auto;
            display: block;
        }

        .piece-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .division-piece {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain;
            opacity: 0;
            transition: opacity 0.5s ease, transform 0.3s ease;
            pointer-events: none;
        }

        .division-piece.placed {
            opacity: 1;
            pointer-events: auto;
            cursor: pointer;
            animation: piecePlace 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .division-piece.placed:hover {
            filter: brightness(1.1);
            transform: scale(1.02);
        }

        @keyframes piecePlace {
            0% { opacity: 0; transform: scale(1.3) rotate(5deg); }
            50% { transform: scale(1.05) rotate(-2deg); }
            100% { opacity: 1; transform: scale(1) rotate(0); }
        }

        /* Pieces Panel */
        .pieces-panel {
            background: white;
            border-radius: 25px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .pieces-title {
            font-size: 1.15em;
            font-weight: 800;
            color: var(--text-dark);
            margin-bottom: 15px;
            text-align: center;
        }

        .pieces-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        @media (min-width: 850px) {
            .pieces-grid {
                grid-template-columns: 1fr;
            }
        }

        .piece-btn {
            background: linear-gradient(135deg, #f8f9fa, #fff);
            border: 3px solid #e0e0e0;
            border-radius: 16px;
            padding: 12px 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .piece-btn:hover:not(.placed) {
            transform: scale(1.03);
            border-color: var(--primary);
            box-shadow: 0 5px 20px rgba(0, 168, 107, 0.3);
        }

        .piece-btn:active:not(.placed) {
            transform: scale(0.97);
        }

        .piece-btn.placed {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            border-color: var(--primary);
            opacity: 0.5;
            cursor: default;
            transform: none;
        }

        .piece-color {
            width: 38px;
            height: 38px;
            border-radius: 12px;
            flex-shrink: 0;
            box-shadow: inset 0 -4px 0 rgba(0,0,0,0.15), 0 3px 8px rgba(0,0,0,0.15);
        }

        .piece-info {
            flex: 1;
            text-align: left;
        }

        .piece-name {
            font-weight: 700;
            font-size: 1em;
            color: var(--text-dark);
        }

        .piece-name-secondary {
            font-size: 0.8em;
            color: #888;
        }

        .piece-check {
            font-size: 1.5em;
        }

        /* Floating Mascot */
        .floating-mascot {
            position: fixed;
            bottom: 15px;
            right: 15px;
            z-index: 100;
        }

        .floating-mascot .mascot {
            font-size: 55px;
            animation: floatBounce 2s ease-in-out infinite;
        }

        @keyframes floatBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        .floating-mascot .speech-bubble {
            bottom: 100%;
            right: 0;
            left: auto;
            transform: none;
            max-width: 220px;
            white-space: normal;
            text-align: center;
            font-size: 1em;
        }

        .floating-mascot .speech-bubble::after {
            left: auto;
            right: 25px;
        }

        .floating-mascot .speech-bubble.show {
            transform: translateY(-10px);
        }

        /* Fun Fact Popup */
        .fact-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            background: white;
            border-radius: 30px;
            padding: 30px;
            max-width: 360px;
            width: 90%;
            text-align: center;
            box-shadow: 0 25px 80px rgba(0,0,0,0.4);
            z-index: 250;
            opacity: 0;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .fact-popup.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
            pointer-events: auto;
        }

        .fact-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .fact-popup-overlay.show {
            opacity: 1;
            pointer-events: auto;
        }

        .fact-emoji {
            font-size: 3.5em;
            margin-bottom: 10px;
        }

        .fact-division-name {
            font-size: 2em;
            font-weight: 800;
            color: var(--primary-dark);
        }

        .fact-division-bn {
            font-size: 1.3em;
            color: #666;
            margin-bottom: 15px;
        }

        .fact-content {
            background: linear-gradient(135deg, #fff9c4, #fff59d);
            border-radius: 18px;
            padding: 18px;
            margin-bottom: 20px;
            border-left: 5px solid var(--accent);
        }

        .fact-label {
            font-weight: 700;
            color: #f57f17;
            margin-bottom: 5px;
            font-size: 0.9em;
        }

        .fact-text {
            font-size: 1.05em;
            color: var(--text-dark);
            line-height: 1.5;
        }

        .fact-close-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 14px 35px;
            border-radius: 30px;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 5px 20px rgba(0, 168, 107, 0.4);
        }

        .fact-close-btn:hover {
            transform: scale(1.05);
        }

        /* Success Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 300;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .modal {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 35px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
            margin: 20px;
            transform: scale(0.7) rotate(-10deg);
            transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .modal-overlay.active .modal {
            transform: scale(1) rotate(0);
        }

        .modal-mascot {
            font-size: 90px;
            animation: mascotCelebrate 1s ease infinite;
        }

        .modal h2 {
            font-size: 2.2em;
            color: white;
            margin: 15px 0;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
        }

        .modal p {
            color: rgba(255,255,255,0.9);
            font-size: 1.15em;
            margin-bottom: 15px;
        }

        .modal-stars {
            font-size: 3.5em;
            margin: 15px 0;
            animation: starPop 0.6s ease;
        }

        @keyframes starPop {
            0% { transform: scale(0); }
            50% { transform: scale(1.4); }
            100% { transform: scale(1); }
        }

        .modal-time {
            background: rgba(255,255,255,0.2);
            padding: 12px 28px;
            border-radius: 25px;
            color: white;
            font-size: 1.4em;
            font-weight: 700;
            display: inline-block;
            margin-bottom: 25px;
        }

        .modal-btn {
            background: white;
            color: var(--purple);
            border: none;
            padding: 16px 45px;
            border-radius: 35px;
            font-size: 1.25em;
            font-weight: 800;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .modal-btn:hover {
            transform: scale(1.05);
        }

        /* Confetti */
        .confetti {
            position: fixed;
            z-index: 400;
            pointer-events: none;
        }

        .confetti-piece {
            position: absolute;
            top: -20px;
            animation: confettiFall 3.5s ease-out forwards;
        }

        @keyframes confettiFall {
            0% { transform: translateY(0) rotate(0deg) scale(1); opacity: 1; }
            100% { transform: translateY(105vh) rotate(1440deg) scale(0.3); opacity: 0; }
        }

        /* Encouragement Pop */
        .encouragement {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            font-size: 3em;
            font-weight: 800;
            color: white;
            text-shadow: 4px 4px 0 var(--secondary), 8px 8px 0 rgba(0,0,0,0.2);
            z-index: 180;
            pointer-events: none;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            white-space: nowrap;
        }

        .encouragement.show {
            transform: translate(-50%, -50%) scale(1);
        }

        /* Learn Mode */
        .learn-card {
            background: white;
            border-radius: 30px;
            padding: 30px;
            box-shadow: var(--shadow);
            max-width: 480px;
            margin: 0 auto;
            text-align: center;
        }

        .learn-map-container {
            width: 100%;
            max-width: 350px;
            margin: 0 auto 20px;
            position: relative;
        }

        .learn-map-bg {
            width: 100%;
            opacity: 0.3;
        }

        .learn-piece-highlight {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .learn-division-name {
            font-size: 2.5em;
            font-weight: 800;
            color: var(--primary-dark);
        }

        .learn-division-bn {
            font-size: 1.6em;
            color: #666;
            margin-bottom: 15px;
        }

        .learn-fact-box {
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid var(--primary);
        }

        .learn-fact-title {
            font-weight: 700;
            color: var(--primary-dark);
            margin-bottom: 8px;
        }

        .speak-btn {
            background: linear-gradient(135deg, var(--secondary), #e74c3c);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 35px;
            font-size: 1.15em;
            font-weight: 700;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
            transition: transform 0.2s;
        }

        .speak-btn:hover {
            transform: scale(1.05);
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
        }

        .nav-btn {
            background: linear-gradient(135deg, var(--purple), #8e44ad);
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 1.6em;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(155, 89, 182, 0.4);
            transition: all 0.3s ease;
        }

        .nav-btn:hover:not(:disabled) {
            transform: scale(1.1);
        }

        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        /* Responsive */
        @media (max-width: 500px) {
            .menu-hero h1 {
                font-size: 1.8em;
            }
            
            .mascot {
                font-size: 80px;
            }
            
            .puzzle-header {
                justify-content: center;
            }
            
            .puzzle-title {
                width: 100%;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-bubbles">
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
    </div>

    <!-- Header -->
    <header class="header">
        <button class="back-btn" id="backBtn" style="visibility: hidden;" onclick="goBack()">‚Üê</button>
        <div class="header-title">
            <span>üáßüá©</span>
            <span id="headerText">Map Puzzle</span>
        </div>
        <div class="lang-selector">
            <button class="lang-btn active" data-lang="en">EN</button>
            <button class="lang-btn" data-lang="bn">‡¶¨‡¶æ‡¶Ç</button>
        </div>
    </header>

    <div class="container">
        <!-- Screen: Main Menu -->
        <div class="screen active" id="menuScreen">
            <div class="menu-hero">
                <div class="mascot-container">
                    <div class="speech-bubble" id="menuSpeech">Let's learn Bangladesh! üáßüá©</div>
                    <div class="mascot" id="menuMascot" onclick="mascotTalk()">üêØ</div>
                </div>
                <h1 id="menuTitle">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶∂‡¶ø‡¶ñ‡¶ø!</h1>
                <p id="menuSubtitle">Learn Bangladesh with fun puzzles!</p>
                
                <div class="menu-buttons">
                    <button class="menu-btn" onclick="startPuzzle()">
                        <span>üß© <span id="btnPuzzle">Play Puzzle!</span></span>
                        <span class="emoji">üéÆ</span>
                    </button>
                    <button class="menu-btn" onclick="startLearn()">
                        <span>üìö <span id="btnLearn">Learn Mode</span></span>
                        <span class="emoji">üéì</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Screen: Puzzle Game -->
        <div class="screen" id="puzzleScreen">
            <div class="puzzle-header">
                <div class="puzzle-title" id="puzzleTitle">üß© Division Puzzle</div>
                <div class="puzzle-progress">
                    <div class="progress-pills" id="progressPills">
                        <div class="progress-pill"></div>
                        <div class="progress-pill"></div>
                        <div class="progress-pill"></div>
                        <div class="progress-pill"></div>
                        <div class="progress-pill"></div>
                        <div class="progress-pill"></div>
                        <div class="progress-pill"></div>
                        <div class="progress-pill"></div>
                    </div>
                    <div class="timer" id="timer">00:00</div>
                </div>
            </div>

            <div class="game-area">
                <div class="map-panel">
                    <div class="map-wrapper" id="mapWrapper">
                        <img src="images/map_background.png" alt="Bangladesh" class="map-background">
                        <div class="piece-overlay">
                            <img src="images/piece_rangpur.png" class="division-piece" id="piece-rangpur" data-id="rangpur">
                            <img src="images/piece_rajshahi.png" class="division-piece" id="piece-rajshahi" data-id="rajshahi">
                            <img src="images/piece_mymensingh.png" class="division-piece" id="piece-mymensingh" data-id="mymensingh">
                            <img src="images/piece_sylhet.png" class="division-piece" id="piece-sylhet" data-id="sylhet">
                            <img src="images/piece_dhaka.png" class="division-piece" id="piece-dhaka" data-id="dhaka">
                            <img src="images/piece_khulna.png" class="division-piece" id="piece-khulna" data-id="khulna">
                            <img src="images/piece_barisal.png" class="division-piece" id="piece-barisal" data-id="barisal">
                            <img src="images/piece_chittagong.png" class="division-piece" id="piece-chittagong" data-id="chittagong">
                        </div>
                    </div>
                </div>

                <div class="pieces-panel">
                    <div class="pieces-title" id="piecesTitle">üéØ Tap to place!</div>
                    <div class="pieces-grid" id="piecesGrid"></div>
                </div>
            </div>
        </div>

        <!-- Screen: Learn Mode -->
        <div class="screen" id="learnScreen">
            <div class="learn-card">
                <div class="learn-map-container">
                    <img src="images/map_background.png" class="learn-map-bg" alt="Bangladesh">
                    <img id="learnPieceImg" class="learn-piece-highlight" src="" alt="">
                </div>
                <div class="learn-division-name" id="learnName">Dhaka</div>
                <div class="learn-division-bn" id="learnNameBn">‡¶¢‡¶æ‡¶ï‡¶æ</div>
                
                <div class="learn-fact-box">
                    <div class="learn-fact-title">üåü Fun Fact!</div>
                    <div id="learnFact">Capital city of Bangladesh!</div>
                </div>
                
                <button class="speak-btn" onclick="speakLearn()">
                    <span>üîä</span>
                    <span id="speakText">Listen!</span>
                </button>
                
                <div class="nav-buttons">
                    <button class="nav-btn" id="prevBtn" onclick="navigateLearn(-1)">‚Üê</button>
                    <button class="nav-btn" id="nextBtn" onclick="navigateLearn(1)">‚Üí</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Mascot -->
    <div class="floating-mascot" id="floatingMascot" style="display: none;">
        <div class="speech-bubble" id="gameSpeech"></div>
        <div class="mascot" onclick="mascotEncourage()">üêØ</div>
    </div>

    <!-- Fact Popup -->
    <div class="fact-popup-overlay" id="factOverlay" onclick="closeFactPopup()"></div>
    <div class="fact-popup" id="factPopup">
        <div class="fact-emoji" id="factEmoji">üèôÔ∏è</div>
        <div class="fact-division-name" id="factName">Dhaka</div>
        <div class="fact-division-bn" id="factNameBn">‡¶¢‡¶æ‡¶ï‡¶æ</div>
        <div class="fact-content">
            <div class="fact-label">üåü Fun Fact!</div>
            <div class="fact-text" id="factText">Capital city!</div>
        </div>
        <button class="fact-close-btn" onclick="closeFactPopup()">Got it! üëç</button>
    </div>

    <!-- Success Modal -->
    <div class="modal-overlay" id="successModal">
        <div class="modal">
            <div class="modal-mascot">üêØ</div>
            <h2 id="modalTitle">üéâ Amazing!</h2>
            <p id="modalText">You completed the map of Bangladesh!</p>
            <div class="modal-stars" id="modalStars">‚≠ê‚≠ê‚≠ê</div>
            <div class="modal-time" id="modalTime">‚è±Ô∏è 00:00</div>
            <button class="modal-btn" onclick="closeModal()">Play Again! üîÑ</button>
        </div>
    </div>

    <!-- Encouragement -->
    <div class="encouragement" id="encouragement"></div>

    <!-- Confetti -->
    <div class="confetti" id="confetti"></div>

    <script>
        // ===== GAME DATA =====
        const DIVISIONS = [
            { 
                id: 'rangpur', 
                name: { en: 'Rangpur', bn: '‡¶∞‡¶Ç‡¶™‡ßÅ‡¶∞' }, 
                color: '#e74c3c',
                emoji: 'üèîÔ∏è',
                fact: { 
                    en: 'You can see Himalayan mountains on clear days! ‚ùÑÔ∏è', 
                    bn: '‡¶™‡¶∞‡¶ø‡¶∑‡ßç‡¶ï‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶®‡ßá ‡¶π‡¶ø‡¶Æ‡¶æ‡¶≤‡¶Ø‡¶º ‡¶™‡¶∞‡ßç‡¶¨‡¶§ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º! ‚ùÑÔ∏è' 
                }
            },
            { 
                id: 'rajshahi', 
                name: { en: 'Rajshahi', bn: '‡¶∞‡¶æ‡¶ú‡¶∂‡¶æ‡¶π‡ßÄ' }, 
                color: '#f1c40f',
                emoji: 'ü•≠',
                fact: { 
                    en: 'Home of the sweetest mangoes in the world! ü•≠', 
                    bn: '‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡ßá‡¶∞ ‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶Æ‡¶ø‡¶∑‡ßç‡¶ü‡¶ø ‡¶Ü‡¶Æ‡ßá‡¶∞ ‡¶¶‡ßá‡¶∂! ü•≠' 
                }
            },
            { 
                id: 'mymensingh', 
                name: { en: 'Mymensingh', bn: '‡¶Æ‡¶Ø‡¶º‡¶Æ‡¶®‡¶∏‡¶ø‡¶Ç‡¶π' }, 
                color: '#e91e9a',
                emoji: 'üéì',
                fact: { 
                    en: 'Has Bangladesh\'s oldest Agricultural University! üåæ', 
                    bn: '‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶æ‡¶ö‡ßÄ‡¶®‡¶§‡¶Æ ‡¶ï‡ßÉ‡¶∑‡¶ø ‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º! üåæ' 
                }
            },
            { 
                id: 'sylhet', 
                name: { en: 'Sylhet', bn: '‡¶∏‡¶ø‡¶≤‡ßá‡¶ü' }, 
                color: '#1abc9c',
                emoji: 'üçµ',
                fact: { 
                    en: 'Beautiful land of tea gardens! üçÉ', 
                    bn: '‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞ ‡¶ö‡¶æ ‡¶¨‡¶æ‡¶ó‡¶æ‡¶®‡ßá‡¶∞ ‡¶¶‡ßá‡¶∂! üçÉ' 
                }
            },
            { 
                id: 'dhaka', 
                name: { en: 'Dhaka', bn: '‡¶¢‡¶æ‡¶ï‡¶æ' }, 
                color: '#3498db',
                emoji: 'üèôÔ∏è',
                fact: { 
                    en: 'Capital city with over 20 million people! üåÜ', 
                    bn: '‡¶∞‡¶æ‡¶ú‡¶ß‡¶æ‡¶®‡ßÄ, ‡ß® ‡¶ï‡ßã‡¶ü‡¶ø‡¶∞‡¶ì ‡¶¨‡ßá‡¶∂‡¶ø ‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∑‡ßá‡¶∞ ‡¶∂‡¶π‡¶∞! üåÜ' 
                }
            },
            { 
                id: 'khulna', 
                name: { en: 'Khulna', bn: '‡¶ñ‡ßÅ‡¶≤‡¶®‡¶æ' }, 
                color: '#e67e22',
                emoji: 'üêÖ',
                fact: { 
                    en: 'Gateway to Sundarbans - home of Royal Bengal Tigers! üêØ', 
                    bn: '‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞‡¶¨‡¶®‡ßá‡¶∞ ‡¶¶‡¶∞‡¶ú‡¶æ - ‡¶∞‡¶Ø‡¶º‡ßá‡¶≤ ‡¶¨‡ßá‡¶ô‡ßç‡¶ó‡¶≤ ‡¶ü‡¶æ‡¶á‡¶ó‡¶æ‡¶∞‡ßá‡¶∞ ‡¶¨‡¶æ‡¶°‡¶º‡¶ø! üêØ' 
                }
            },
            { 
                id: 'barisal', 
                name: { en: 'Barisal', bn: '‡¶¨‡¶∞‡¶ø‡¶∂‡¶æ‡¶≤' }, 
                color: '#9b59b6',
                emoji: 'üö£',
                fact: { 
                    en: 'Called "Venice of the East" - so many rivers! üåä', 
                    bn: '"‡¶™‡ßç‡¶∞‡¶æ‡¶ö‡ßç‡¶Ø‡ßá‡¶∞ ‡¶≠‡ßá‡¶®‡¶ø‡¶∏" - ‡¶Ö‡¶®‡ßá‡¶ï ‡¶®‡¶¶‡ßÄ! üåä' 
                }
            },
            { 
                id: 'chittagong', 
                name: { en: 'Chittagong', bn: '‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ' }, 
                color: '#27ae60',
                emoji: 'üèñÔ∏è',
                fact: { 
                    en: 'Has Cox\'s Bazar - world\'s longest sea beach! üèÑ', 
                    bn: '‡¶ï‡¶ï‡ßç‡¶∏‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞ - ‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡ßá‡¶∞ ‡¶¶‡ßÄ‡¶∞‡ßç‡¶ò‡¶§‡¶Æ ‡¶∏‡¶Æ‡ßÅ‡¶¶‡ßç‡¶∞ ‡¶∏‡ßà‡¶ï‡¶§! üèÑ' 
                }
            }
        ];

        const ENCOURAGEMENTS = {
            en: ['Amazing! üåü', 'Wonderful! üéâ', 'Fantastic! ‚ú®', 'Super! üöÄ', 'Brilliant! üí´', 'Great job! üèÜ', 'You rock! üé∏'],
            bn: ['‡¶Ö‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£! üåü', '‡¶ö‡¶Æ‡ßé‡¶ï‡¶æ‡¶∞! üéâ', '‡¶¶‡¶æ‡¶∞‡ßÅ‡¶£! ‚ú®', '‡¶∏‡ßÅ‡¶™‡¶æ‡¶∞! üöÄ', '‡¶¨‡¶æ‡¶π! üí´', '‡¶ñ‡ßÅ‡¶¨ ‡¶≠‡¶æ‡¶≤‡ßã! üèÜ', '‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶¶‡¶æ‡¶∞‡ßÅ‡¶£! üé∏']
        };

        const MASCOT_MESSAGES = {
            welcome: { en: "Hi friend! Let's learn Bangladesh! üáßüá©", bn: "‡¶π‡¶æ‡¶á ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ! ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶∂‡¶ø‡¶ñ‡¶ø! üáßüá©" },
            start: { en: "Tap a division to place it! üëÜ", bn: "‡¶è‡¶ï‡¶ü‡¶ø ‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó‡ßá ‡¶ü‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ï‡¶∞‡ßã! üëÜ" },
            placed: { en: ["Yay!", "Perfect!", "You got it!", "Awesome!"], bn: ["‡¶¨‡¶æ‡¶π!", "‡¶™‡¶æ‡¶∞‡¶´‡ßá‡¶ï‡ßç‡¶ü!", "‡¶∏‡¶†‡¶ø‡¶ï!", "‡¶¶‡¶æ‡¶∞‡ßÅ‡¶£!"] },
            halfway: { en: "Halfway done! Keep going! üí™", bn: "‡¶Ö‡¶∞‡ßç‡¶ß‡ßá‡¶ï ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá! ‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶ì! üí™" },
            almost: { en: "Almost there! You can do it! üåü", bn: "‡¶™‡ßç‡¶∞‡¶æ‡¶Ø‡¶º ‡¶∂‡ßá‡¶∑! ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶™‡¶æ‡¶∞‡¶¨‡ßá! üåü" },
            complete: { en: "WOW! You're a Bangladesh expert! üèÜ", bn: "‡¶¨‡¶æ‡¶π! ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑‡¶ú‡ßç‡¶û! üèÜ" },
            click: { en: ["I believe in you!", "You're doing great!", "Keep it up!"], bn: ["‡¶Ü‡¶Æ‡¶ø ‡¶§‡ßã‡¶Æ‡¶æ‡¶ï‡ßá ‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶æ‡¶∏ ‡¶ï‡¶∞‡¶ø!", "‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶∞‡¶õ!", "‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶ì!"] }
        };

        // ===== GAME STATE =====
        let currentLang = 'en';
        let currentScreen = 'menu';
        let placedPieces = [];
        let timerInterval = null;
        let elapsedTime = 0;
        let learnIndex = 0;

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', () => {
            initLanguage();
            showMenuSpeech();
            
            // Add click handlers to division pieces
            document.querySelectorAll('.division-piece').forEach(piece => {
                piece.addEventListener('click', () => {
                    if (piece.classList.contains('placed')) {
                        showFactPopup(piece.dataset.id);
                    }
                });
            });
        });

        // ===== LANGUAGE =====
        function initLanguage() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentLang = btn.dataset.lang;
                    updateTexts();
                });
            });
        }

        function updateTexts() {
            const isEn = currentLang === 'en';
            document.getElementById('headerText').textContent = isEn ? 'Map Puzzle' : '‡¶Æ‡¶æ‡¶®‡¶ö‡¶ø‡¶§‡ßç‡¶∞ ‡¶ß‡¶æ‡¶Å‡¶ß‡¶æ';
            document.getElementById('menuTitle').textContent = isEn ? 'Learn Bangladesh!' : '‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶∂‡¶ø‡¶ñ‡¶ø!';
            document.getElementById('menuSubtitle').textContent = isEn ? 'Fun puzzles await you!' : '‡¶Æ‡¶ú‡¶æ‡¶∞ ‡¶ß‡¶æ‡¶Å‡¶ß‡¶æ ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶õ‡ßá!';
            document.getElementById('btnPuzzle').textContent = isEn ? 'Play Puzzle!' : '‡¶ß‡¶æ‡¶Å‡¶ß‡¶æ ‡¶ñ‡ßá‡¶≤‡ßã!';
            document.getElementById('btnLearn').textContent = isEn ? 'Learn Mode' : '‡¶∂‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶°';
            document.getElementById('puzzleTitle').textContent = isEn ? 'üß© Division Puzzle' : 'üß© ‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó‡ßá‡¶∞ ‡¶ß‡¶æ‡¶Å‡¶ß‡¶æ';
            document.getElementById('piecesTitle').textContent = isEn ? 'üéØ Tap to place!' : 'üéØ ‡¶¨‡¶∏‡¶æ‡¶§‡ßá ‡¶ü‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ï‡¶∞‡ßã!';
            document.getElementById('speakText').textContent = isEn ? 'Listen!' : '‡¶∂‡ßã‡¶®‡ßã!';
            
            if (currentScreen === 'puzzle') renderPieceButtons();
            if (currentScreen === 'learn') showLearnItem();
            showMenuSpeech();
        }

        // ===== NAVIGATION =====
        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id + 'Screen').classList.add('active');
            currentScreen = id;
            document.getElementById('backBtn').style.visibility = id === 'menu' ? 'hidden' : 'visible';
            document.getElementById('floatingMascot').style.display = id === 'puzzle' ? 'block' : 'none';
        }

        function goBack() {
            stopTimer();
            showScreen('menu');
            showMenuSpeech();
        }

        // ===== MASCOT =====
        function showMenuSpeech() {
            const speech = document.getElementById('menuSpeech');
            speech.textContent = MASCOT_MESSAGES.welcome[currentLang];
            setTimeout(() => speech.classList.add('show'), 300);
        }

        function mascotTalk() {
            const mascot = document.getElementById('menuMascot');
            mascot.classList.add('celebrate');
            setTimeout(() => mascot.classList.remove('celebrate'), 600);
            
            const messages = MASCOT_MESSAGES.click[currentLang];
            const speech = document.getElementById('menuSpeech');
            speech.textContent = messages[Math.floor(Math.random() * messages.length)];
            
            speak(speech.textContent);
        }

        function mascotEncourage() {
            const messages = MASCOT_MESSAGES.click[currentLang];
            showGameSpeech(messages[Math.floor(Math.random() * messages.length)]);
        }

        function showGameSpeech(text, duration = 3000) {
            const speech = document.getElementById('gameSpeech');
            speech.textContent = text;
            speech.classList.add('show');
            setTimeout(() => speech.classList.remove('show'), duration);
        }

        // ===== PUZZLE GAME =====
        function startPuzzle() {
            showScreen('puzzle');
            placedPieces = [];
            elapsedTime = 0;
            
            // Reset all pieces
            document.querySelectorAll('.division-piece').forEach(p => p.classList.remove('placed'));
            document.querySelectorAll('.progress-pill').forEach(p => p.classList.remove('filled'));
            
            renderPieceButtons();
            startTimer();
            
            setTimeout(() => {
                showGameSpeech(MASCOT_MESSAGES.start[currentLang]);
                speak(MASCOT_MESSAGES.start[currentLang]);
            }, 500);
        }

        function renderPieceButtons() {
            const grid = document.getElementById('piecesGrid');
            grid.innerHTML = '';

            const shuffled = [...DIVISIONS].sort(() => Math.random() - 0.5);

            shuffled.forEach(div => {
                const isPlaced = placedPieces.includes(div.id);
                const btn = document.createElement('button');
                btn.className = 'piece-btn' + (isPlaced ? ' placed' : '');
                btn.onclick = () => !isPlaced && placePiece(div.id);
                btn.innerHTML = `
                    <div class="piece-color" style="background: ${div.color}"></div>
                    <div class="piece-info">
                        <div class="piece-name">${div.name[currentLang]}</div>
                        <div class="piece-name-secondary">${currentLang === 'en' ? div.name.bn : div.name.en}</div>
                    </div>
                    ${isPlaced ? '<span class="piece-check">‚úÖ</span>' : ''}
                `;
                grid.appendChild(btn);
            });
        }

        function placePiece(divisionId) {
            if (placedPieces.includes(divisionId)) return;

            const division = DIVISIONS.find(d => d.id === divisionId);
            placedPieces.push(divisionId);

            // Show piece on map
            const piece = document.getElementById('piece-' + divisionId);
            piece.classList.add('placed');

            // Update progress pills
            document.querySelectorAll('.progress-pill')[placedPieces.length - 1].classList.add('filled');

            // Show encouragement
            showEncouragement();

            // Mascot message
            const messages = MASCOT_MESSAGES.placed[currentLang];
            showGameSpeech(messages[Math.floor(Math.random() * messages.length)] + ' ' + division.name[currentLang] + '!');

            // Speak name
            speak(division.name[currentLang]);

            // Update buttons
            renderPieceButtons();

            // Milestone messages
            if (placedPieces.length === 4) {
                setTimeout(() => {
                    showGameSpeech(MASCOT_MESSAGES.halfway[currentLang], 4000);
                    speak(MASCOT_MESSAGES.halfway[currentLang]);
                }, 1500);
            } else if (placedPieces.length === 7) {
                setTimeout(() => {
                    showGameSpeech(MASCOT_MESSAGES.almost[currentLang], 4000);
                    speak(MASCOT_MESSAGES.almost[currentLang]);
                }, 1500);
            }

            // Check win
            if (placedPieces.length === 8) {
                setTimeout(completePuzzle, 800);
            }
        }

        function showEncouragement() {
            const msgs = ENCOURAGEMENTS[currentLang];
            const msg = msgs[Math.floor(Math.random() * msgs.length)];
            const el = document.getElementById('encouragement');
            el.textContent = msg;
            el.classList.add('show');
            setTimeout(() => el.classList.remove('show'), 1200);
        }

        function showFactPopup(divisionId) {
            const div = DIVISIONS.find(d => d.id === divisionId);
            document.getElementById('factEmoji').textContent = div.emoji;
            document.getElementById('factName').textContent = div.name.en;
            document.getElementById('factNameBn').textContent = div.name.bn;
            document.getElementById('factText').textContent = div.fact[currentLang];
            
            document.getElementById('factOverlay').classList.add('show');
            document.getElementById('factPopup').classList.add('show');
            
            speak(div.name[currentLang] + '. ' + div.fact[currentLang]);
        }

        function closeFactPopup() {
            document.getElementById('factOverlay').classList.remove('show');
            document.getElementById('factPopup').classList.remove('show');
        }

        function completePuzzle() {
            stopTimer();
            
            // Calculate stars
            let stars = '‚≠ê';
            if (elapsedTime < 45) stars = '‚≠ê‚≠ê‚≠ê';
            else if (elapsedTime < 90) stars = '‚≠ê‚≠ê';

            document.getElementById('modalStars').textContent = stars;
            document.getElementById('modalTime').textContent = '‚è±Ô∏è ' + formatTime(elapsedTime);
            document.getElementById('modalTitle').textContent = currentLang === 'en' ? 'üéâ Amazing!' : 'üéâ ‡¶Ö‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£!';
            document.getElementById('modalText').textContent = MASCOT_MESSAGES.complete[currentLang];
            
            document.getElementById('successModal').classList.add('active');
            
            createConfetti();
            speak(MASCOT_MESSAGES.complete[currentLang]);
        }

        function closeModal() {
            document.getElementById('successModal').classList.remove('active');
            goBack();
        }

        // ===== TIMER =====
        function startTimer() {
            elapsedTime = 0;
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                elapsedTime++;
                updateTimerDisplay();
            }, 1000);
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        function updateTimerDisplay() {
            document.getElementById('timer').textContent = formatTime(elapsedTime);
        }

        function formatTime(sec) {
            const m = Math.floor(sec / 60);
            const s = sec % 60;
            return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        // ===== LEARN MODE =====
        function startLearn() {
            showScreen('learn');
            learnIndex = 0;
            showLearnItem();
        }

        function showLearnItem() {
            const div = DIVISIONS[learnIndex];
            
            document.getElementById('learnPieceImg').src = 'images/piece_' + div.id + '.png';
            document.getElementById('learnName').textContent = div.name.en;
            document.getElementById('learnNameBn').textContent = div.name.bn;
            document.getElementById('learnFact').textContent = div.fact[currentLang];

            document.getElementById('prevBtn').disabled = learnIndex === 0;
            document.getElementById('nextBtn').disabled = learnIndex === DIVISIONS.length - 1;

            speak(div.name[currentLang]);
        }

        function navigateLearn(dir) {
            learnIndex = Math.max(0, Math.min(DIVISIONS.length - 1, learnIndex + dir));
            showLearnItem();
        }

        function speakLearn() {
            const div = DIVISIONS[learnIndex];
            speak(div.name[currentLang] + '. ' + div.fact[currentLang]);
        }

        // ===== TTS =====
        function speak(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utter = new SpeechSynthesisUtterance(text);
                utter.lang = currentLang === 'bn' ? 'bn-BD' : 'en-US';
                utter.rate = 0.9;
                utter.pitch = 1.1;
                window.speechSynthesis.speak(utter);
            }
        }

        // ===== CONFETTI =====
        function createConfetti() {
            const container = document.getElementById('confetti');
            container.innerHTML = '';
            const colors = ['#e74c3c', '#f1c40f', '#27ae60', '#3498db', '#9b59b6', '#1abc9c', '#e67e22', '#e91e9a'];
            
            for (let i = 0; i < 100; i++) {
                const piece = document.createElement('div');
                piece.className = 'confetti-piece';
                piece.style.left = Math.random() * 100 + 'vw';
                piece.style.background = colors[Math.floor(Math.random() * colors.length)];
                piece.style.animationDelay = Math.random() * 2.5 + 's';
                piece.style.animationDuration = (3 + Math.random() * 2) + 's';
                const size = 8 + Math.random() * 14;
                piece.style.width = size + 'px';
                piece.style.height = size + 'px';
                piece.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
                container.appendChild(piece);
            }
            
            setTimeout(() => container.innerHTML = '', 5000);
        }
    </script>
</body>
</html>
